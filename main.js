!function(){"use strict";class e{constructor(e,t,s,n,r,o,i){let{name:a,link:l}=e;this._name=a,this._link=l,this.cardId=s,this._cardLikeStatus=n,this._cardSelector=t,this._handleImageClick=r,this._handleDelete=o,this._handleLike=i,this._cardElement=document.querySelector(t).content.querySelector(".element").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".element__image"),this._cardName=this._cardElement.querySelector(".element__name"),this._cardLikeButton=this._cardElement.querySelector(".element__like-button"),this._cardDeleteButton=this._cardElement.querySelector(".element__delete-card-button"),this._cardDeleteModal=document.getElementById("delete-card-modal")}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>{this._handleLike(this)})),this._cardDeleteButton.addEventListener("click",(()=>{this._handleDelete(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._cardImage,this._cardName)}))}getId(){return this.cardId}removeCard(){this._cardElement.remove(),this._cardElement=null}toggleCardLikeButton(){this._cardLikeButton.classList.toggle("element__like-button_active")}checkIfLikeActive(){return!this._cardLikeButton.classList.contains("element__like-button_active")}returnCardElement(){return this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardName.textContent=this._name,this._cardLikeStatus&&this._cardLikeButton.classList.add("element__like-button_active"),this._cardElement}}class t{constructor(e,t){this._settings=e,this._formElement=t,this._inputElements=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._settings.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}_hasValidInput(){return this._inputElements.some((e=>!e.validity.valid))}_setEventHandlers(){this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleSubmitButtonState()}))}))}toggleSubmitButtonState(){this._hasValidInput(this._inputElements)?(this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.setAttribute("disabled","")):(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.removeAttribute("disabled"))}resetValidation(){this.toggleSubmitButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventHandlers()}}const s={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},n=Array.from(document.querySelectorAll(s.formSelector));console.log("formElements: ",n);const r={};n.forEach((e=>{const n=new t(s,e);r[e.name]=n,n.enableValidation(e)}));class o{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._containerElement=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e,t){this._containerElement[t](e)}}document.querySelector(".elements__list");const i=document.querySelectorAll(".modal"),a=(Array.from(i),document.querySelector("#edit-modal"),document.querySelector("#add-card-modal"),document.querySelector("#open-card-modal")),l=(a.querySelector(".modal__image"),a.querySelector(".modal__image-title"),document.forms["edit-profile-form"]),c=l.querySelector("[name = userName]"),d=l.querySelector("[name = aboutMe]"),h=document.querySelector(".profile__button-edit"),u=document.querySelector(".profile__button-add"),_=(document.querySelector(".modal__save"),document.querySelector(".element__delete-card-button"),document.querySelector(".modal__delete-button"),document.querySelector(".profile__edit")),m=document.querySelector(".profile__profile-info");document.querySelector(".profile__profile-heading"),m.querySelector(".profile__subtitle");class p{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>this.close(this._popupElement))),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class E extends p{constructor(e,t){super(e),this._handleSubmit=t,this._formElement=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__save"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e=Array.from(this._popupElement.querySelectorAll(".modal__input")),t={};return e.forEach((e=>{console.log("input: ",e),t[e.name]=e.value})),console.log("GET INPUT VALUES: ",t),t}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{this._handleSubmit(this._getInputValues(),this._formElement),e.preventDefault()})),super.setEventListeners()}}document.getElementById("header-image").src="4e8e0a1d604782a0dff8.svg";const g=new class extends p{constructor(e){super(e),this._modalImage=this._popupElement.querySelector(".modal__image"),this._modalImageTitle=this._popupElement.querySelector(".modal__image-title")}open(e,t){this._modalImage.src=t,this._modalImage.alt=e,this._modalImageTitle.textContent=e,super.open()}}("#open-card-modal");g.setEventListeners();const f=new E("#edit-modal",(function(e,t){console.log(e),f.renderLoading(!0),S.editProfile(e).then((s=>{L.setUserInfo(e),t.reset()})).then((e=>{f.close()})).catch(S.logError).finally((e=>{f.renderLoading(!1)}))})),v=new E("#add-card-modal",(function(e,t){v.renderLoading(!0),console.log(e);const s={name:e.title,link:e.link};S.createCard(s).then((t=>{console.log(t);const s=t._id;B(e,"prepend",s)})).then((e=>{v.close(),t.reset()})).catch(S.logError).finally((e=>{v.renderLoading(!1)}))})),b=new E("#avatar-change-modal",(function(e,t){b.renderLoading(!0),S.avatarChange(e).then((s=>{t.reset(),b.close(),L.setAvatar(e.avatarLink)})).catch(S.logError).finally((e=>{b.renderLoading(!1)}))})),y=new class extends p{constructor(e,t,s){super(e),this._handleConfirm=t,this._handleDeleteListener=s,this._submitButton=this._popupElement.querySelector(".modal__save"),this._submitButtonText=this._submitButton.textContent}setEventListeners(){this._submitButton.addEventListener("click",(()=>{this._handleDeleteListener(this._cardObject)})),super.setEventListeners()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}open(e){this._cardObject=e,super.open()}}("#delete-card-modal",I,(function(e){y.renderLoading(!0,"Deleting..."),S.deleteCard(e.getId()).then((t=>{y.close(),e.removeCard()})).catch(S.logError).finally((e=>{y.renderLoading(!1)}))})),L=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._aboutMeElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{userName:this._nameElement.textContent,userAbout:this._aboutMeElement.textContent}}setAvatar(e){this._avatarElement.src=e}setUserInfo(e){let{userName:t,aboutMe:s}=e;this._nameElement.textContent=t,this._aboutMeElement.textContent=s}}(".profile__profile-heading",".profile__subtitle",".profile__avatar"),S=new class{constructor(e){this._options=e,this._baseUrl=e.baseUrl,this._headers=e.headers}async _checkResponse(e){return e.ok?e.json():Promise.reject(`Error. Status: ${e.status}`)}logError(e){console.error(e)}async getUserInformation(){return fetch(`${this._baseUrl}users/me`,this._options).then(this._checkResponse)}async getInitialCards(){return console.warn("getInitialCards() ran"),fetch(`${this._baseUrl}cards`,{headers:this._headers}).then(this._checkResponse)}async editProfile(e){let{userName:t,aboutMe:s}=e;return console.warn("editProfile() ran"),fetch(`${this._baseUrl}users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}async createCard(e){let{name:t,link:s}=e;return console.warn("createCard() ran"),console.log("name",t),console.log("link",s),fetch(`${this._baseUrl}cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse).then((e=>(console.log("Fetch data:",e),e)))}async deleteCard(e){return console.warn("deleteCard() ran"),fetch(`${this._baseUrl}cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}async likeCard(e){return console.warn("likeCard() ran"),fetch(`${this._baseUrl}cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({_isLiked:!0})}).then(this._checkResponse)}async dislikeCard(e){return console.warn("dislikeCard() ran"),fetch(`${this._baseUrl}cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}async avatarChange(e){return console.warn("avatarChange() ran"),fetch(`${this._baseUrl}users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatarLink})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1/",headers:{authorization:"37d10eee-d0ba-4e04-840e-0ebf682b3c60","Content-Type":"application/json"}});let k;function C(e,t){g.open(t.textContent,e.src)}function I(e){y.open(e)}function q(e){console.log(e),e.checkIfLikeActive()?S.likeCard(e.cardId).then((t=>{e.toggleCardLikeButton()})).catch(S.logError):S.dislikeCard(e.cardId).then((t=>e.toggleCardLikeButton())).catch(S.logError)}function B(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append",n=arguments.length>2?arguments[2]:void 0;null==n&&(n=t._id);const r=new e({name:t.name||t.title,link:t.link},"#add-elements",n,t.isLiked,C,I,q);k.addItem(r.returnCardElement(),s)}console.log(r),S.getUserInformation().then((e=>{const t=e.name,s=e.about;L.setUserInfo({userName:t,aboutMe:s}),L.setAvatar(e.avatar)})).catch(S.logError),S.getInitialCards().then((e=>{k=new o({items:e,renderer:B},".elements__list"),k.renderItems()})).catch(S.logError),h.addEventListener("click",(()=>{const{userName:e,userAbout:t}=L.getUserInfo();c.value=e,d.value=t,f.open(),r.edit_profile_form.resetValidation()})),u.addEventListener("click",(()=>{r.add_card_form.toggleSubmitButtonState(),v.open()})),_.addEventListener("click",(()=>{r.avatar_change_form.toggleSubmitButtonState(),b.open()})),f.setEventListeners(),v.setEventListeners(),y.setEventListeners(),b.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFlaUksa0JBQWtCMUksaUJBQWlCLElBR3BEOEIsRUFBYzNFLGlCQUFpQixTQUFTLEtBQ3RDc0QsRUFBZWtJLGNBQWMvSSwwQkFDN0IrRSxFQUFnQnJDLE1BQU0sSUFHeEJQLEVBQWlCNUUsaUJBQWlCLFNBQVMsS0FDekNzRCxFQUFlbUksbUJBQW1CaEosMEJBQ2xDdUYsRUFBZ0I3QyxNQUFNLElBSXhCeUIsRUFBaUJyQixvQkFDakJpQyxFQUFnQmpDLG9CQUNoQjZDLEVBQWdCN0Msb0JBQ2hCeUMsRUFBZ0J6QyxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmsgfSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgY2FyZElkLFxuICAgIGNhcmRMaWtlU3RhdHVzLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlLFxuICAgIGhhbmRsZUNhcmRMaWtlXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xuICAgIHRoaXMuY2FyZElkID0gY2FyZElkO1xuICAgIHRoaXMuX2NhcmRMaWtlU3RhdHVzID0gY2FyZExpa2VTdGF0dXM7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZSA9IGhhbmRsZURlbGV0ZTtcbiAgICB0aGlzLl9oYW5kbGVMaWtlID0gaGFuZGxlQ2FyZExpa2U7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkTmFtZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbmFtZVwiKTtcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5lbGVtZW50X19saWtlLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmVsZW1lbnRfX2RlbGV0ZS1jYXJkLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLl9jYXJkRGVsZXRlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGV0ZS1jYXJkLW1vZGFsXCIpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAvLyB0aGlzLl9oYW5kbGVMaWtlKHRoaXMuX2NhcmRJZCk7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2NhcmRJbWFnZSwgdGhpcy5fY2FyZE5hbWUpO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FyZElkO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICB0b2dnbGVDYXJkTGlrZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgY2hlY2tJZkxpa2VBY3RpdmUoKSB7XG4gICAgaWYgKFxuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlXCIpXG4gICAgKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybkNhcmRFbGVtZW50KCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZE5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIGlmICh0aGlzLl9jYXJkTGlrZVN0YXR1cykge1xuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImVsZW1lbnRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAvKiBzZXR0aW5nczogc3RvcmVzIFNFTEVDVE9SUyBhbmQgZm9ybSBDTEFTU0VTXG4gICAgICAgICAgICAgICAgdGhpcyBpcyBjb25maWdPYmogZnJvbSB2YWxpZGF0aW9uLmpzKi9cblxuICAvLyBmb3JtRWxlbWVudDogRk9STSBFTEVNRU5UIHRvIGJlIHZhbGlkYXRlZFxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGFzVmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRFbGVtZW50cy5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgX3NldEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy50b2dnbGVTdWJtaXRCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVTdWJtaXRCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVsZW1lbnRzKSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICAgIH1cbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLnRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRIYW5kbGVycygpO1xuICB9XG59XG4iLCJpbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmNvbnN0IGNvbmZpZ09iaiA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuLy8gRlVOQ1RJT04gQ0FMTFNcbmNvbnN0IGZvcm1FbGVtZW50cyA9IEFycmF5LmZyb20oXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnT2JqLmZvcm1TZWxlY3Rvcilcbik7XG5jb25zb2xlLmxvZyhcImZvcm1FbGVtZW50czogXCIsIGZvcm1FbGVtZW50cyk7XG5cbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9OyAvLyBvYmplY3QgY29udGFpbmluZyBGb3JtVmFsaWRhdGlvbiBjbGFzc2VzXG5cbi8vIGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xuLy8gY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtZm9ybVwiKTtcbi8vIGNvbnN0IGVkaXRBdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItY2hhbmdlLWZvcm1cIik7XG5cbi8vIGV4cG9ydCBjb25zdCBhZGRDYXJkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnT2JqLCBhZGRDYXJkRm9ybSk7XG4vLyBleHBvcnQgY29uc3QgZWRpdFByb2ZpbGVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbi8vICAgY29uZmlnT2JqLFxuLy8gICBlZGl0UHJvZmlsZUZvcm1cbi8vICk7XG4vLyBleHBvcnQgY29uc3QgZWRpdEF2YXRhclZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZ09iaiwgZWRpdEF2YXRhckZvcm0pO1xuXG5mb3JtRWxlbWVudHMuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgY29uc3QgbmV3VmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZ09iaiwgZm9ybUVsZW1lbnQpO1xuICBmb3JtVmFsaWRhdG9yc1tmb3JtRWxlbWVudC5uYW1lXSA9IG5ld1ZhbGlkYXRpb247XG4gIG5ld1ZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbihmb3JtRWxlbWVudCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICAvKipcbiAgICogSXRlcmF0ZXMgdGhyb3VnaCBhbiBhcnJheSBvZiBjYXJkc1xuICAgKiAocmV0dXJuZWQgZnJvbSBgYXBpLmdldEluaXRpYWxDYXJkcygpYCBmb3IgZXhhbXBsZSlcbiAgICogYW5kIGNhbGxzIF9yZW5kZXJlciAoYHJlbmRlckNhcmQoY2FyZCwgbWV0aG9kPVwiYXBwZW5kXCIpYClcbiAgICovXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNhbWUgYXMgY2FsbGJhY2sgaW4gJ2FkZENhcmRGb3JtJyBldmVudCBsaXN0ZW5lclxuICAgKiBAcGFyYW0ge0NhcmR9IGNhcmQgYENhcmRgIG9iamVjdFxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWV0aG9kIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIG1ldGhvZFxuICAgKiB1c2VkIHRvIGFkZCB0aGUgY2FyZCB0byB0aGUgZG9jdW1lbnQgZmxvdyAoYGFwcGVuZGAgb3IgYHByZXBlbmRgKVxuICAgKi9cbiAgYWRkSXRlbShjYXJkLCBtZXRob2QpIHtcbiAgICB0aGlzLl9jb250YWluZXJFbGVtZW50W21ldGhvZF0oY2FyZCk7XG4gIH1cbn1cbiIsIi8qIGV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBjYXJkTmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBjYXJkTmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIGNhcmROYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgY2FyZE5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgY2FyZE5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBjYXJkTmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTsgKi9cblxuLy8gTk9ERVMgTk9ERVMgTk9ERVMgTk9ERVNcbmV4cG9ydCBjb25zdCBlbGVtZW50c0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19saXN0XCIpO1xuXG4vLyBtb2RhbCBub2Rlc1xuZXhwb3J0IGNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XG5leHBvcnQgY29uc3QgbW9kYWxzQXJyYXkgPSBBcnJheS5mcm9tKG1vZGFscyk7XG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IG9wZW5DYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI29wZW4tY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBtb2RhbEltYWdlID0gb3BlbkNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBtb2RhbEltYWdlVGl0bGUgPSBvcGVuQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbWFnZS10aXRsZVwiXG4pO1xuXG4vLyBmb3JtIG5vZGVzXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGUtZm9ybVwiXTtcbi8vIGV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcblxuLy8gaW5wdXQgbm9kZXNcbmV4cG9ydCBjb25zdCBlZGl0TW9kYWxOYW1lSW5wdXQgPVxuICBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcIltuYW1lID0gdXNlck5hbWVdXCIpO1xuZXhwb3J0IGNvbnN0IGVkaXRNb2RhbEFib3V0bWVJbnB1dCA9XG4gIGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFwiW25hbWUgPSBhYm91dE1lXVwiKTtcbi8vIGV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWxUaXRsZUlucHV0ID1cbi8vICAgYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIltuYW1lID0gbmFtZV1cIik7XG4vLyBleHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsSW1hZ2VsaW5rSW5wdXQgPVxuLy8gICBhZGRDYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFwiW25hbWUgPSBsaW5rXVwiKTtcblxuLy8gYnV0dG9uIG5vZGVzXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLWVkaXRcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLWFkZFwiKTtcbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5lbGVtZW50X19kZWxldGUtY2FyZC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBkZWxldGVDb25maXJtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2RlbGV0ZS1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0XCIpO1xuXG5leHBvcnQgY29uc3Qgc2VjdGlvblByb2ZpbGVJbmZvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fcHJvZmlsZS1pbmZvXCJcbik7XG5leHBvcnQgY29uc3Qgc2VjdGlvblByb2ZpbGVJbmZvSGVhZGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX3Byb2ZpbGUtaGVhZGluZ1wiXG4pO1xuZXhwb3J0IGNvbnN0IHNlY3Rpb25Qcm9maWxlSW5mb1N1YnRpdGxlID1cbiAgc2VjdGlvblByb2ZpbGVJbmZvLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fc3VidGl0bGVcIik7XG4vLyBleHBvcnQgY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2VcIik7XG4iLCIvKipcbiAqIGBQb3B1cC5qc2AgY2xhc3MgaXNvbGF0ZXMgbWV0aG9kcyBmb3IgZGVhbGluZyB3aXRoXG4gKiBwb3B1cHMgKG1vZGFscylcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogT3BlbnMgdGhlIG1vZGFsIGFuZCBhZGRzIHRoZSBldmVudCBsaXN0ZW5lciBmb3JcbiAgICogdGhlIGBFc2NgIGtleVxuICAgKi9cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICAvKipcbiAgICogYFBVQkxJQ2BcbiAgICpcbiAgICogQ2xvc2VzIHRoZSBtb2RhbCBhbmQgcmVtb3ZlcyB0aGVcbiAgICogZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBgRXNjYCBrZXlcbiAgICovXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBgUFJJVkFURWBcbiAgICpcbiAgICogQ2xvc2VzIHRoZSBtb2RhbCBpZiB0aGUgcHJlc3NlZCBrZXkgaXMgYEVzY2BcbiAgICogQHBhcmFtIHsqfSBldmVudFxuICAgKi9cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgY2xvc2UtYnV0dG9uXG4gICAqICh0aGUgJ3gnIGF0IHRoZSB0b3AgcmlnaHQgY29ybmVyIG9mIHRoZSBtb2RhbHMpXG4gICAqXG4gICAqIFNldHMgZXZlbnQgbGlzdGVuZXIgZm9yIHdoZW4gdXNlciBjbGlja3NcbiAgICogb3V0IG9mIHRoZSBtb2RhbDsgdGhpcyB3aWxsIGNsb3NlIHRoZSBtb2RhbFxuICAgKi9cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gYWRkIGEgJ2NsaWNrJyBldmVudCBsaXN0ZW5lciB0byB0aGUgJ2Nsb3NlJyBpY29uIG9mIHRoZSBwb3B1cFxuICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcblxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSh0aGlzLl9wb3B1cEVsZW1lbnQpKTtcbiAgICAvLyBhZGQgYW4gZXZlbnQgbGlzdGVuZXIgdG8gY2xvc2UgdGhlIHBvcHVwIHdoZW4gdGhlIHVzZXJcbiAgICAvLyAgICBjbGlja3Mgb3V0c2lkZSB0aGUgbW9kYWxcblxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG4vKipcbiAqIENoaWxkIG9mIGBQb3B1cGAgY2xhc3MuIENhbiBvYnRhaW4gdmFsdWVzIGZyb21cbiAqIGlucHV0IGVsZW1lbnRzIG9mIHRoZSBtb2RhbCBmb3JtcywgYW5kIHNldCB0aGVcbiAqIGV2ZW50IGxpc3RlbmVycyB0byB0aGUgcG9wdXBzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIHZhbHVlcyBvZiB0aGUgZmllbGRzXG4gICAqIGZyb20gdGhlIHJlc3BlY3RpdmUgZm9ybXMgZm9yIHRoZSBlZGl0LXByb2ZpbGUgYW5kXG4gICAqIGFkZC1jYXJkIG1vZGFscyB1cG9uIHN1Y2Nlc3NmdWwgc3VibWlzc2lvblxuICAgKi9cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0RWxlbWVudHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXG4gICAgKTtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIGlucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIC8vIGlmIChpbnB1dC5uYW1lID09PSBcImNhcmROYW1lXCIpIHtcbiAgICAgIC8vICAgaW5wdXRWYWx1ZXMubmFtZSA9IGlucHV0LnZhbHVlO1xuICAgICAgLy8gfSBlbHNlIHtcbiAgICAgIC8vICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgIC8vIH1cbiAgICAgIGNvbnNvbGUubG9nKFwiaW5wdXQ6IFwiLCBpbnB1dCk7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgICAgLy8gaW5wdXRWYWx1ZXMubmFtZSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKFwiR0VUIElOUFVUIFZBTFVFUzogXCIsIGlucHV0VmFsdWVzKTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIHBvcHVwIGFjY29yZGluZ1xuICAgKiB0byB0aGUgZXZlbnQgaGFuZGxlciBmdW5jdGlvbiBwYXNzZWQgdG8gdGhlXG4gICAqIGNsYXNzIGNvbnN0cnVjdG9yLlxuICAgKlxuICAgKiBFYWNoIHBvcHVwIGVsZW1lbnQgd2lsbCBnZXQgaXRzIG93biBoYW5kbGVyIGZ1bmN0aW9uLlxuICAgKi9cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSwgdGhpcy5fZm9ybUVsZW1lbnQpO1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IGhlYWRlckltZ1NyYyBmcm9tIFwiLi4vaW1hZ2VzL2hlYWRlci1pbWFnZS5zdmdcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCB7XG4gIGZvcm1WYWxpZGF0b3JzLFxuICAvLyBhZGRDYXJkVmFsaWRhdG9yLFxuICAvLyBlZGl0UHJvZmlsZVZhbGlkYXRvcixcbiAgLy8gZWRpdEF2YXRhclZhbGlkYXRvcixcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHtcbiAgZWRpdE1vZGFsTmFtZUlucHV0LFxuICBlZGl0TW9kYWxBYm91dG1lSW5wdXQsXG4gIGVkaXRCdXR0b24sXG4gIGFkZENhcmRCdXR0b24sXG4gIGVkaXRBdmF0YXJCdXR0b24sXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanNcIjtcblxuY29uc3QgaGVhZGVySW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWFkZXItaW1hZ2VcIik7XG5oZWFkZXJJbWcuc3JjID0gaGVhZGVySW1nU3JjO1xuXG4vLyBDTEFTUyBJTklUSUFMSVNBVElPTlMgQ0xBU1MgSU5JVElBTElTQVRJT05TIENMQVNTIElOSVRJQUxJU0FUSU9OUyBDTEFTUyBJTklUSUFMSVNBVElPTlNcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjb3Blbi1jYXJkLW1vZGFsXCIpO1xucG9wdXBJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjZWRpdC1tb2RhbFwiLCBoYW5kbGVQcm9maWxlU3VibWl0KTtcbmNvbnN0IGFkZE5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVOZXdDYXJkU3VibWl0XG4pO1xuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2F2YXRhci1jaGFuZ2UtbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyU3VibWl0XG4pO1xuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aERlbGV0ZShcbiAgXCIjZGVsZXRlLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlQ2FyZERlbGV0ZSxcbiAgaGFuZGxlQ2FyZERlbGV0ZUxpc3RlbmVyXG4pO1xuXG5jb25zdCBwcm9maWxlSW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgXCIucHJvZmlsZV9fcHJvZmlsZS1oZWFkaW5nXCIsXG4gIFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIsXG4gIFwiLnByb2ZpbGVfX2F2YXRhclwiXG4pO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9cIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMzdkMTBlZWUtZDBiYS00ZTA0LTg0MGUtMGViZjY4MmIzYzYwXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuY29uc29sZS5sb2coZm9ybVZhbGlkYXRvcnMpO1xuXG5hcGlcbiAgLmdldFVzZXJJbmZvcm1hdGlvbigpXG4gIC50aGVuKChkYXRhKSA9PiB7XG4gICAgY29uc3QgdXNlck5hbWUgPSBkYXRhLm5hbWU7XG4gICAgY29uc3QgYWJvdXRNZSA9IGRhdGEuYWJvdXQ7XG4gICAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oeyB1c2VyTmFtZSwgYWJvdXRNZSB9KTtcbiAgICBwcm9maWxlSW5mby5zZXRBdmF0YXIoZGF0YS5hdmF0YXIpO1xuICB9KVxuICAuY2F0Y2goYXBpLmxvZ0Vycm9yKTtcblxubGV0IHNlY3Rpb247XG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChjYXJkcykgPT4ge1xuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHsgaXRlbXM6IGNhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxuICAgICAgXCIuZWxlbWVudHNfX2xpc3RcIlxuICAgICk7XG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goYXBpLmxvZ0Vycm9yKTtcblxuLy8gRlVOQ1RJT05TIEZVTkNUSU9OUyBGVU5DVElPTlMgRlVOQ1RJT05TXG4vKipcbiAqIE9wZW5zIHRoZSBpbWFnZSBwcmV2aWV3IG1vZGFsXG4gKiBAcGFyYW0ge0RPTSBFbGVtZW50fSBjYXJkSW1hZ2UgdGhlIERPTSBFbGVtZW50IHdpdGggdGhlIGNhcmQncyBpbWFnZVxuICogQHBhcmFtIHtET00gRWxlbWVudH0gY2FyZE5hbWUgdGhlIERPTSBFbGVtZW50IHdpdGggdGhlIGNhcmQncyB0aXRsZS9uYW1lXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZEltYWdlLCBjYXJkTmFtZSkge1xuICBwb3B1cEltYWdlLm9wZW4oY2FyZE5hbWUudGV4dENvbnRlbnQsIGNhcmRJbWFnZS5zcmMpO1xufVxuXG4vKipcbiAqIFNldHMgdGhlIHN1Ym1pdHRlZCBpbmZvcm1hdGlvbiB0byB0aGUgcGFnZSBwcm9maWxlIHNlY3Rpb25cbiAqIGFuZCBzZW5kcyB0aGUgZGF0YSB0aHJvdWdoIHRoZSBBUEkgY2xhc3MgdG8gdGhlIHNlcnZlclxuICogQHBhcmFtIHtBcnJheX0gZGF0YVxuICovXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlU3VibWl0KGRhdGEsIGZvcm1FbGVtZW50KSB7XG4gIGNvbnNvbGUubG9nKGRhdGEpO1xuICBlZGl0UHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5lZGl0UHJvZmlsZShkYXRhKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgICB9KVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaChhcGkubG9nRXJyb3IpXG4gICAgLmZpbmFsbHkoKHJlcykgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTmV3Q2FyZFN1Ym1pdChkYXRhLCBmb3JtRWxlbWVudCkge1xuICBhZGROZXdDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgY29uc29sZS5sb2coZGF0YSk7XG4gIGNvbnN0IGNhcmRPYmplY3QgPSB7IG5hbWU6IGRhdGEudGl0bGUsIGxpbms6IGRhdGEubGluayB9O1xuICBhcGlcbiAgICAvLyAuY3JlYXRlQ2FyZChkYXRhKVxuICAgIC5jcmVhdGVDYXJkKGNhcmRPYmplY3QpXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgIGNvbnN0IHJlc3VsdElkID0gcmVzdWx0Ll9pZDtcbiAgICAgIHJlbmRlckNhcmQoZGF0YSwgXCJwcmVwZW5kXCIsIHJlc3VsdElkKTtcbiAgICB9KVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGFkZE5ld0NhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaChhcGkubG9nRXJyb3IpXG4gICAgLmZpbmFsbHkoKHJlcykgPT4ge1xuICAgICAgYWRkTmV3Q2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZUxpc3RlbmVyKGNhcmQpIHtcbiAgZGVsZXRlQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJEZWxldGluZy4uLlwiKTtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoY2FyZC5nZXRJZCgpKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goYXBpLmxvZ0Vycm9yKVxuICAgIC5maW5hbGx5KChyZXMpID0+IHtcbiAgICAgIGRlbGV0ZUNhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZShjYXJkKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKGNhcmQpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShjYXJkKSB7XG4gIGNvbnNvbGUubG9nKGNhcmQpO1xuICBpZiAoY2FyZC5jaGVja0lmTGlrZUFjdGl2ZSgpKSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZC5jYXJkSWQpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmQudG9nZ2xlQ2FyZExpa2VCdXR0b24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goYXBpLmxvZ0Vycm9yKTtcbiAgfSBlbHNlIHtcbiAgICBhcGlcbiAgICAgIC5kaXNsaWtlQ2FyZChjYXJkLmNhcmRJZClcbiAgICAgIC50aGVuKChyZXMpID0+IGNhcmQudG9nZ2xlQ2FyZExpa2VCdXR0b24oKSlcbiAgICAgIC5jYXRjaChhcGkubG9nRXJyb3IpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChkYXRhLCBmb3JtRWxlbWVudCkge1xuICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmF2YXRhckNoYW5nZShkYXRhKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGZvcm1FbGVtZW50LnJlc2V0KCk7XG4gICAgICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICAgIHByb2ZpbGVJbmZvLnNldEF2YXRhcihkYXRhLmF2YXRhckxpbmspO1xuICAgIH0pXG4gICAgLmNhdGNoKGFwaS5sb2dFcnJvcilcbiAgICAuZmluYWxseSgocmVzKSA9PiB7XG4gICAgICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbi8qKlxuICogUmVuZGVycyBjYXJkcyB1c2luZyB0aGUgZ2l2ZW4gcGFyYW1zXG4gKiBAcGFyYW0ge29iamVjdH0gaW5wdXQgb2JqZWN0IHdpdGggJ25hbWUnIGFuZCAnbGluaycgcHJvcGVydGllc1xuICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZCB0aGF0IHRha2VzIGVpdGhlciAnYXBwZW5kJyBvciAncHJlcGVuZCcgZGVwZW5kaW5nIG9uIHdoZXJlIHRoZSBjYXJkIHNob3VsZCBnbyBpbiB0aGUgRE9NXG4gKi9cbmZ1bmN0aW9uIHJlbmRlckNhcmQoaW5wdXQsIG1ldGhvZCA9IFwiYXBwZW5kXCIsIGNhcmRJZCkge1xuICBpZiAoY2FyZElkID09IHVuZGVmaW5lZCkge1xuICAgIGNhcmRJZCA9IGlucHV0Ll9pZDtcbiAgfVxuICBjb25zdCBjYXJkQ2xhc3MgPSBuZXcgQ2FyZChcbiAgICB7IG5hbWU6IGlucHV0Lm5hbWUgfHwgaW5wdXQudGl0bGUsIGxpbms6IGlucHV0LmxpbmsgfSxcbiAgICBcIiNhZGQtZWxlbWVudHNcIixcbiAgICBjYXJkSWQsXG4gICAgaW5wdXQuaXNMaWtlZCxcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZUNhcmREZWxldGUsXG4gICAgaGFuZGxlQ2FyZExpa2VcbiAgKTtcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRDbGFzcy5yZXR1cm5DYXJkRWxlbWVudCgpLCBtZXRob2QpO1xufVxuXG4vLyBFVkVOVCBMSVNURU5FUlMgRVZFTlQgTElTVEVORVJTIEVWRU5UIExJU1RFTkVSUyBFVkVOVCBMSVNURU5FUlNcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgeyB1c2VyTmFtZSwgdXNlckFib3V0IH0gPSBwcm9maWxlSW5mby5nZXRVc2VySW5mbygpO1xuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSB1c2VyTmFtZTtcbiAgZWRpdE1vZGFsQWJvdXRtZUlucHV0LnZhbHVlID0gdXNlckFib3V0O1xuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbiAgZm9ybVZhbGlkYXRvcnMuZWRpdF9wcm9maWxlX2Zvcm0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9ycy5hZGRfY2FyZF9mb3JtLnRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKCk7XG4gIGFkZE5ld0NhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9ycy5hdmF0YXJfY2hhbmdlX2Zvcm0udG9nZ2xlU3VibWl0QnV0dG9uU3RhdGUoKTtcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyBGb3JtICdzdWJtaXQnIGhhbmRsZXJzXG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGROZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuZWRpdEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuLyoqXG4gKiBDaGlsZCBvZiBQb3B1cCBjbGFzc1xuICpcbiAqIE1ldGhvZCBgb3BlbihuYW1lLCBsaW5rKWAgc2V0cyBpbmZvcm1hdGlvbiBvbiB0aGVcbiAqIGltYWdlLW9wZW4gbW9kYWwgYW5kIG9wZW5zIHRoYXQgbW9kYWxcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAvLyB0aGlzLl9vcGVuQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNvcGVuLWNhcmQtbW9kYWxcIik7XG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9tb2RhbEltYWdlVGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19pbWFnZS10aXRsZVwiXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVucyB0aGUgaW1hZ2UgaW4gdGhlIHJlc3BlY3RpdmUgbW9kYWwgYW5kIHNldHNcbiAgICogdGhlIG1vZGFsIHZhbHVlcyBhY2NvcmRpbmcgdG8gdGhvc2UgaW5cbiAgICogY2FyZCBlbGVtZW50c1xuICAgKiBAcGFyYW0geyp9IG5hbWUgTmFtZSBvbiB0aGUgY2FyZFxuICAgKiBAcGFyYW0geyp9IGxpbmsgTGluayBvZiB0aGUgaW1hZ2Ugb24gdGhlIGNhcmRcbiAgICovXG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIHRoaXMuX21vZGFsSW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9tb2RhbEltYWdlLmFsdCA9IG5hbWU7XG4gICAgdGhpcy5fbW9kYWxJbWFnZVRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUNvbmZpcm0sIGhhbmRsZUNhcmREZWxldGVMaXN0ZW5lcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0gPSBoYW5kbGVDb25maXJtO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUxpc3RlbmVyID0gaGFuZGxlQ2FyZERlbGV0ZUxpc3RlbmVyO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUxpc3RlbmVyKHRoaXMuX2NhcmRPYmplY3QpO1xuICAgIH0pO1xuXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBvcGVuKGNhcmRPYmplY3QpIHtcbiAgICB0aGlzLl9jYXJkT2JqZWN0ID0gY2FyZE9iamVjdDtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ2xhc3MgdGhhdCBpc29sYXRlcyBtZXRob2RzIGRlYWxpbmcgd2l0aCB0aGUgdXNlclxuICogaW5mb3JtYXRpb24uXG4gKlxuICogQG1ldGhvZCBgZ2V0VXNlckluZm8oKWAgcmV0dXJucyBhbmQgb2JqZWN0IHdpdGggbmFtZSBhbmRcbiAqIGFib3V0IGZyb20gdGhlIHBhZ2VcbiAqXG4gKiBAbWV0aG9kIGBzZXRVc2VySW5mbygpYCB0YWtlcyBhbmQgb2JqZWN0IHdpdGggYHVzZXJOYW1lYCBhbmRcbiAqIGBhYm91dE1lYCBmaWVsZHMsIGFuZCBzZXRzIHRoZW0gdG8gdGhlIHBhZ2VcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGFib3V0TWVTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9hYm91dE1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRNZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogQHJldHVybnMgb2JqZWN0IGNvbnRhaW5pbmcgcHJvZmlsZSBuYW1lIGFuZCBhYm91dFxuICAgKi9cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgdXNlckluZm8gPSB7XG4gICAgICB1c2VyTmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICB1c2VyQWJvdXQ6IHRoaXMuX2Fib3V0TWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gICAgcmV0dXJuIHVzZXJJbmZvO1xuICB9XG5cbiAgc2V0QXZhdGFyKGF2YXRhckxpbmspIHtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhckxpbms7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9IGB7dXNlck5hbWUsIGFib3V0TWV9YFxuICAgKi9cbiAgc2V0VXNlckluZm8oeyB1c2VyTmFtZSwgYWJvdXRNZSB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyTmFtZTtcbiAgICB0aGlzLl9hYm91dE1lRWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0TWU7XG4gIH1cbn1cbiIsIi8vIGF1dGggdG9rZW46IDM3ZDEwZWVlLWQwYmEtNGUwNC04NDBlLTBlYmY2ODJiM2M2MFxuLyoqXG4gKiBDbGFzcyB0aGF0IGRlYWxzIHdpdGggaW50ZXJhY3Rpb25zIHdpdGggdGhlIEFQSS5cbiAqIEFueXRoaW5nIHRoYXQgYWZmZWN0cyB0aGUgY29udGVudCBvZiB0aGUgcGFnZVxuICogc2hvdWxkIGJlIHJlZmxlY3RlZCB3aXRoIGEgcmVxdWVzdCB0byB0aGUgQVBJLFxuICogYW5kIHRoZSBmdW5jdGlvbmFsaXR5IG9mIHRoaXMgY2xhc3MgcmVmbGVjdHMgdGhhdC5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIGFzeW5jIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yLiBTdGF0dXM6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9XG4gIH1cblxuICBsb2dFcnJvcihlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmRzIGEgR0VUIHJlcXVlc3QgdG8gdGhlIGB1c2Vycy9tZWAgZW5kcG9pbnQgYW5kIHJldHVybnNcbiAgICogdGhlIHVzZXJuYW1lIGFuZCB1c2VyLWFib3V0IGFzIGFuIG9iamVjdFxuICAgKiBAcmV0dXJucyBvYmplY3QgY29udGFpbmluZyB1c2VyICduYW1lJyBhbmQgJ2Fib3V0J1xuICAgKi9cbiAgYXN5bmMgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfXVzZXJzL21lYCwgdGhpcy5fb3B0aW9ucykudGhlbihcbiAgICAgIHRoaXMuX2NoZWNrUmVzcG9uc2VcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEZldGNoZXMgdGhlIC9jYXJkcyBlbmRwb2ludCBhbmQgY29udmVydHMgcmVzdWx0cyBpbnRvXG4gICAqIGFuIGFycmF5IG9mIHRoZSBvYmplY3QgZnJvbSB0aGUgYXBpXG4gICAqIEByZXR1cm5zIGFycmF5IG9mIGNhcmRzIHRvIGJlIG9wZXJhdGVkIHVwb24gZnJvbSB0aGUgL2NhcmRzIGVuZHBvaW50XG4gICAqL1xuICBhc3luYyBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgY29uc29sZS53YXJuKFwiZ2V0SW5pdGlhbENhcmRzKCkgcmFuXCIpO1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfWNhcmRzYCwgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzIH0pLnRoZW4oXG4gICAgICB0aGlzLl9jaGVja1Jlc3BvbnNlXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGZXRjaGVzIHRoZSBgdXNlcnMvbWVgIGVuZHBvaW50IGFuZCBhZGRzIHRoZSB2YWx1ZXNcbiAgICogZnJvbSB0aGUgZm9ybSBmaWVsZHMgdG8gdGhlIEFQSSB1cG9uIHN1Y2Nlc3NmdWxcbiAgICogc3VibWlzc2lvblxuICAgKi9cbiAgYXN5bmMgZWRpdFByb2ZpbGUoeyB1c2VyTmFtZSwgYWJvdXRNZSB9KSB7XG4gICAgY29uc29sZS53YXJuKFwiZWRpdFByb2ZpbGUoKSByYW5cIik7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9dXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IHVzZXJOYW1lLFxuICAgICAgICBhYm91dDogYWJvdXRNZSxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgYSBQT1NUIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB3aXRoIHRoZSBjYXJkXG4gICAqIG5hbWUgYW5kIGxpbmsgdG8gdGhlIHBob3RvLCBhZGRpbmcgaXQgdG8gdGhlIGFycmF5XG4gICAqIG9mIGNhcmQtb2JqZWN0cyBvbiB0aGUgc2VydmVyLlxuICAgKiBAcGFyYW0ge29iamVjdH0gYHtjYXJkTmFtZSwgbGlua31gXG4gICAqIEByZXR1cm5zIGBQcm9taXNlYFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIGNvbnNvbGUud2FybihcImNyZWF0ZUNhcmQoKSByYW5cIik7XG4gICAgY29uc29sZS5sb2coXCJuYW1lXCIsIG5hbWUpO1xuICAgIGNvbnNvbGUubG9nKFwibGlua1wiLCBsaW5rKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH1jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lOiBuYW1lLCBsaW5rOiBsaW5rIH0pLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJGZXRjaCBkYXRhOlwiLCBkYXRhKTsgLy8gTG9nIGRhdGFcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgY29uc29sZS53YXJuKFwiZGVsZXRlQ2FyZCgpIHJhblwiKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH1jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhc3luYyBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICBjb25zb2xlLndhcm4oXCJsaWtlQ2FyZCgpIHJhblwiKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH1jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBfaXNMaWtlZDogdHJ1ZSxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhc3luYyBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICBjb25zb2xlLndhcm4oXCJkaXNsaWtlQ2FyZCgpIHJhblwiKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH1jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhc3luYyBhdmF0YXJDaGFuZ2UoZGF0YSkge1xuICAgIGNvbnNvbGUud2FybihcImF2YXRhckNoYW5nZSgpIHJhblwiKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH11c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXJMaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJjYXJkSWQiLCJjYXJkTGlrZVN0YXR1cyIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGUiLCJoYW5kbGVDYXJkTGlrZSIsIm5hbWUiLCJsaW5rIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZExpa2VTdGF0dXMiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlIiwiX2hhbmRsZUxpa2UiLCJfY2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRJbWFnZSIsIl9jYXJkTmFtZSIsIl9jYXJkTGlrZUJ1dHRvbiIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiX2NhcmREZWxldGVNb2RhbCIsImdldEVsZW1lbnRCeUlkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdldElkIiwicmVtb3ZlQ2FyZCIsInJlbW92ZSIsInRvZ2dsZUNhcmRMaWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiY2hlY2tJZkxpa2VBY3RpdmUiLCJjb250YWlucyIsInJldHVybkNhcmRFbGVtZW50Iiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJhZGQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dEVsZW1lbnRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiaW5wdXRFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsIl9oYXNWYWxpZElucHV0Iiwic29tZSIsIl9zZXRFdmVudEhhbmRsZXJzIiwiZm9yRWFjaCIsInRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiY29uZmlnT2JqIiwiZm9ybVNlbGVjdG9yIiwiZm9ybUVsZW1lbnRzIiwiY29uc29sZSIsImxvZyIsImZvcm1WYWxpZGF0b3JzIiwibmV3VmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyRWxlbWVudCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJjYXJkIiwibWV0aG9kIiwibW9kYWxzIiwib3BlbkNhcmRNb2RhbCIsImVkaXRQcm9maWxlRm9ybSIsImZvcm1zIiwiZWRpdE1vZGFsTmFtZUlucHV0IiwiZWRpdE1vZGFsQWJvdXRtZUlucHV0IiwiZWRpdEJ1dHRvbiIsImFkZENhcmRCdXR0b24iLCJlZGl0QXZhdGFyQnV0dG9uIiwic2VjdGlvblByb2ZpbGVJbmZvIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dEVsZW1lbnRzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicG9wdXBJbWFnZSIsIl9tb2RhbEltYWdlIiwiX21vZGFsSW1hZ2VUaXRsZSIsImVkaXRQcm9maWxlUG9wdXAiLCJkYXRhIiwiYXBpIiwiZWRpdFByb2ZpbGUiLCJ0aGVuIiwicmVzIiwicHJvZmlsZUluZm8iLCJzZXRVc2VySW5mbyIsInJlc2V0IiwiY2F0Y2giLCJsb2dFcnJvciIsImZpbmFsbHkiLCJhZGROZXdDYXJkUG9wdXAiLCJjYXJkT2JqZWN0IiwidGl0bGUiLCJjcmVhdGVDYXJkIiwicmVzdWx0IiwicmVzdWx0SWQiLCJfaWQiLCJyZW5kZXJDYXJkIiwiZWRpdEF2YXRhclBvcHVwIiwiYXZhdGFyQ2hhbmdlIiwic2V0QXZhdGFyIiwiYXZhdGFyTGluayIsImRlbGV0ZUNhcmRQb3B1cCIsImhhbmRsZUNvbmZpcm0iLCJoYW5kbGVDYXJkRGVsZXRlTGlzdGVuZXIiLCJfaGFuZGxlQ29uZmlybSIsIl9oYW5kbGVEZWxldGVMaXN0ZW5lciIsIl9jYXJkT2JqZWN0IiwiaGFuZGxlQ2FyZERlbGV0ZSIsImRlbGV0ZUNhcmQiLCJuYW1lU2VsZWN0b3IiLCJhYm91dE1lU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9hYm91dE1lRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJBYm91dCIsImFib3V0TWUiLCJvcHRpb25zIiwiX29wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJlcnJvciIsImdldFVzZXJJbmZvcm1hdGlvbiIsImZldGNoIiwiZ2V0SW5pdGlhbENhcmRzIiwid2FybiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJfcmVmMiIsImxpa2VDYXJkIiwiX2lzTGlrZWQiLCJkaXNsaWtlQ2FyZCIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJzZWN0aW9uIiwiY2FyZEltYWdlIiwiY2FyZE5hbWUiLCJjYXJkQ2xhc3MiLCJpc0xpa2VkIiwiY2FyZHMiLCJlZGl0X3Byb2ZpbGVfZm9ybSIsImFkZF9jYXJkX2Zvcm0iLCJhdmF0YXJfY2hhbmdlX2Zvcm0iXSwic291cmNlUm9vdCI6IiJ9